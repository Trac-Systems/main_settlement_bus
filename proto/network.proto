syntax = "proto3";

package network.v1;

enum MessageType {
    MESSAGE_TYPE_UNSPECIFIED = 0;
    MESSAGE_TYPE_LIVENESS_REQUEST = 1;
    MESSAGE_TYPE_LIVENESS_RESPONSE = 2;
    MESSAGE_TYPE_BROADCAST_TRANSACTION_REQUEST = 3;
    MESSAGE_TYPE_BROADCAST_TRANSACTION_RESPONSE = 4;
}


// Warning: Do not change the numeric values of existing enum fields. They are part of the public API.
// New values can be added, but existing values must never be renumbered or deleted.
enum ResultCode {
    RESULT_CODE_UNSPECIFIED = 0;
    RESULT_CODE_OK = 1;
    RESULT_CODE_INVALID_PAYLOAD = 2;
    RESULT_CODE_RATE_LIMITED = 3;
    RESULT_CODE_SIGNATURE_INVALID = 4;
    RESULT_CODE_UNEXPECTED_ERROR = 5;
    RESULT_CODE_TIMEOUT = 6;
    RESULT_CODE_NODE_HAS_NO_WRITE_ACCESS = 7;
    RESULT_CODE_TX_ACCEPTED_PROOF_UNAVAILABLE = 8;
    RESULT_CODE_NODE_OVERLOADED = 9;
    RESULT_CODE_TX_ALREADY_PENDING = 10;
    RESULT_CODE_OPERATION_TYPE_UNKNOWN = 11;
    RESULT_CODE_SCHEMA_VALIDATION_FAILED = 12;
    RESULT_CODE_REQUESTER_ADDRESS_INVALID = 13;
    RESULT_CODE_REQUESTER_PUBLIC_KEY_INVALID = 14;
    RESULT_CODE_TX_HASH_MISMATCH = 15;
    RESULT_CODE_TX_SIGNATURE_INVALID = 16;
    RESULT_CODE_TX_EXPIRED = 17;
    RESULT_CODE_TX_ALREADY_EXISTS = 18;
    RESULT_CODE_OPERATION_ALREADY_COMPLETED = 19;
    RESULT_CODE_REQUESTER_NOT_FOUND = 20;
    RESULT_CODE_INSUFFICIENT_FEE_BALANCE = 21;
    RESULT_CODE_EXTERNAL_BOOTSTRAP_EQUALS_MSB_BOOTSTRAP = 22;
    RESULT_CODE_SELF_VALIDATION_FORBIDDEN = 23;
    RESULT_CODE_ROLE_NODE_ENTRY_NOT_FOUND = 24;
    RESULT_CODE_ROLE_NODE_ALREADY_WRITER = 25;
    RESULT_CODE_ROLE_NODE_NOT_WHITELISTED = 26;
    RESULT_CODE_ROLE_NODE_NOT_WRITER = 27;
    RESULT_CODE_ROLE_NODE_IS_INDEXER = 28;
    RESULT_CODE_ROLE_ADMIN_ENTRY_MISSING = 29;
    RESULT_CODE_ROLE_INVALID_RECOVERY_CASE = 30;
    RESULT_CODE_ROLE_UNKNOWN_OPERATION = 31;
    RESULT_CODE_ROLE_INVALID_WRITER_KEY = 32;
    RESULT_CODE_ROLE_INSUFFICIENT_FEE_BALANCE = 33;
    RESULT_CODE_MSB_BOOTSTRAP_MISMATCH = 34;
    RESULT_CODE_EXTERNAL_BOOTSTRAP_NOT_DEPLOYED = 35;
    RESULT_CODE_EXTERNAL_BOOTSTRAP_TX_MISSING = 36;
    RESULT_CODE_EXTERNAL_BOOTSTRAP_MISMATCH = 37;
    RESULT_CODE_BOOTSTRAP_ALREADY_EXISTS = 38;
    RESULT_CODE_TRANSFER_RECIPIENT_ADDRESS_INVALID = 39;
    RESULT_CODE_TRANSFER_RECIPIENT_PUBLIC_KEY_INVALID = 40;
    RESULT_CODE_TRANSFER_AMOUNT_TOO_LARGE = 41;
    RESULT_CODE_TRANSFER_SENDER_NOT_FOUND = 42;
    RESULT_CODE_TRANSFER_INSUFFICIENT_BALANCE = 43;
    RESULT_CODE_TRANSFER_RECIPIENT_BALANCE_OVERFLOW = 44;
    RESULT_CODE_TX_HASH_INVALID_FORMAT = 45;
    RESULT_CODE_INTERNAL_ENQUEUE_VALIDATION_FAILED = 46;
    RESULT_CODE_TX_ACCEPTED_RECEIPT_MISSING = 47;
    RESULT_CODE_VALIDATOR_RESPONSE_TX_TYPE_INVALID = 48;
    RESULT_CODE_VALIDATOR_RESPONSE_TX_TYPE_UNKNOWN = 49;
    RESULT_CODE_VALIDATOR_RESPONSE_TX_TYPE_UNSUPPORTED = 50;
    RESULT_CODE_VALIDATOR_RESPONSE_SCHEMA_INVALID = 51;
    RESULT_CODE_PENDING_REQUEST_MISSING_TX_DATA = 52;
    RESULT_CODE_PROOF_PAYLOAD_MISMATCH = 53;
    RESULT_CODE_VALIDATOR_WRITER_KEY_NOT_REGISTERED = 54;
    RESULT_CODE_VALIDATOR_ADDRESS_MISMATCH = 55;
    RESULT_CODE_VALIDATOR_NODE_ENTRY_NOT_FOUND = 56;
    RESULT_CODE_VALIDATOR_NODE_NOT_WRITER = 57;
    RESULT_CODE_VALIDATOR_WRITER_KEY_MISMATCH = 58;
    RESULT_CODE_VALIDATOR_TX_OBJECT_INVALID = 59;
    RESULT_CODE_VALIDATOR_VA_MISSING = 60;
}

message LivenessRequest {
    bytes nonce = 1;
    bytes signature = 2;
}

message LivenessResponse {
    bytes nonce = 1;
    bytes signature = 2;
    ResultCode result = 3;
}

message BroadcastTransactionRequest {
    bytes data = 1;
    bytes nonce = 2;
    bytes signature = 3;
}

message BroadcastTransactionResponse {
    bytes nonce = 1;
    bytes signature = 2;
    bytes proof = 3;
    uint64 appendedAt = 4;
    ResultCode result = 5;
}

message ProofData {
    bytes proof = 1;
    uint64 appendedAt = 2;
}

message MessageHeader {
    MessageType type = 1;
    string id = 2;
    uint64 timestamp = 3;
    oneof field {
        LivenessRequest                       liveness_request = 4;
        LivenessResponse                      liveness_response = 5;
        BroadcastTransactionRequest           broadcast_transaction_request = 6;
        BroadcastTransactionResponse          broadcast_transaction_response = 7;
    }
    repeated string capabilities = 8;
}
